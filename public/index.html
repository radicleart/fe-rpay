<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv6vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="rpay-pay-card.css">
    
    <!-- link to the SqPaymentForm library -->
    <script type="text/javascript" src="https://js.squareupsandbox.com/v2/paymentform"></script>
    <!-- link to the local custom styles for SqPaymentForm -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&display=swap" rel="stylesheet">
    <title><%= htmlWebpackPlugin.options.title %></title>
  </head>
  <body class="bg-dark">
    <noscript>You need javascript.</noscript>
    <div id="opcode" class="text-white mx-3"></div>
    <script>
      /**
      setTimeout(function () {
        window.eventBus.$on('rpayEvent', function (data) {
          localStorage.removeItem('OP_INVOICE')
          document.getElementById('opcode').innerHTML = data.opcode;
        })
      }, 5000);
      **/
      const urlParams = new URLSearchParams(window.location.search);
      const operation = urlParams.get('operation');
      let risidioCardMode = 'payment-flow'
      if (operation) {
        risidioCardMode = operation
      }
      let useNetwork = 'testnet'
      let risidioBaseApi = 'http://api.risidio.local'
      if (location.href.indexOf('https://trpay.risidio.com') > -1) {
        risidioBaseApi = 'https://tapi.risidio.com'
      } else if (location.href.indexOf('https://rpay.risidio.com') > -1) {
        risidioBaseApi = 'https://api.risidio.com'
        useNetwork = mainnet
      }
      const lookAndFeel = {
        variant0: 'danger',
        variant1: 'warning',
        variant2: 'info',
        variant3: 'light',
        labels: {
          titleSelling: 'Sell Your Item',
          title: 'Mint Your Item',
          numberUnits: 'How many items?',
          quantityLabel: 'Tokens'
        }
      }
      const payment = {
        forceNew: false,
        amountFiat: 0.5,
        currency: 'GBP',
        paymentCode: 'po-12324',
        allowMultiples: true,
        stxPaymentAddress: 'ST1R1061ZT6KPJXQ7PAXPFB6ZAZ6ZWW28G8HXK9G5',
        ethPaymentAddress: '0xe31b011344f3f03dba31eeb12308fa446165b7b4',
        paymentOption: 'stacks',
        paymentOptions: [
          { allowFiat: true },
          { allowBitcoin: true },
          { allowLightning: true },
          { allowStacks: true }, 
          { allowLSAT: false },
          { allowEthereum: true }
        ],
        creditAttributes: {
          start: 5,
          min: 2,
          max: 10,
          step: 1
        },
        squarePay: {
          applicationId: 'sandbox-sq0idb-B8CL6u-_2GdwAvkgg6M7WA',
          locationId: 'LA14YJ0CQM53A',
          squareUrl: 'squareupsandbox'
        }
      }
      const selling = {
      }
      const marketConfig = {
        oneLayout: true,
        searchMenu: false,
        sideMenu: false,
        projectId: 'ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW.thisisnumberone'
      }
      const gaiaAsset = {
        gaiaUsername: 'radicle_art.id.blockstack',
        assetHashMinted: 'e25722b4e9481bdfaffb0d3b88c1badd31e45dcb79f639cada783666dd95c8ff',
        // assetHash: '5dd6d4318967820c49c1c83831ca17390a83776d183f44b21b55d5ff92653c7c',
        // assetHash: '1c0b7b80e72eebf0f60a3ba6c53a99ba7bd5ef2ac4fec3be3e659fd1d6a1b44b',
        // assetHash: '8d2c4c44ad131300b8d7ac86b14fa1e321f362e9d20c6dd2881c64abf26ff30f',
        // bd890ccc7427d47b4b86b734c919feb1b64ce088271e315964c32f0dd10efd04
        // 2522cec483346f41c9458823328a56b02f80c3d98a93213e3af7a951db16ed59
        // assetHash: '5a3d19eb907234cfa37ecee895d2f60d84f4174642fc0224db729231be0cb9b2',
        assetHash: '5a3d19eb907234cfa37ecee895d2f60d84f4174642fc0224db729231be0cb9b2',
        name: 'Green One',
        editions: 100,
        imageUrl: 'https://images.prismic.io/risidio-journal/5757dd30-d293-4586-a99b-bdce237f7a69_alexander-sinn-KgLtFCgfC28-unsplash.png?auto=compress,format',
        saleData: {
          saleType: 1,
          incrementPrice: 10,
          buyNowOrStartingPrice: 10,
          reservePrice: 10,
          biddingEndTime: 1615716030000
        }
      }
      const minter = {
        forceNew: true,
        item: {
        },
        preferredNetwork: 'stacks risidio',
        networks: [
          {
            network: 'stacks risidio',
            enabled: true,
            functionName: 'mint-token',
            contractAddress: 'ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW',
            contractName: 'thisisnumberone-v1'
          },
          {
            network: 'stacks connect',
            enabled: true,
            functionName: 'mint-token',
            contractAddress: 'ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW',
            contractName: 'loopbomb'
          },
          {
            network: 'ethereum',
            enabled: false,
            functionName: 'mint-token',
            contractAddress: '0xD32311b42F0F4B592A2a388F90725f4af686C51b'
          }
        ],
        enableRoyalties: true,
        beneficiaries: []
        /**
        beneficiaries: [
          {
            username: 'albert.id',
            role: 'owner',
            email: 'owner@somewhere.com',
            royalty: 3,
            chainAddress: 'ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW',
          }
        ]
        **/
      }
      const configuration = {
        // gaiaAppDomains: ['http://localhost:8080', 'http://localhost:8081', 'http://localhost:8082'],
        gaiaAppDomains: [],
        gaiaAsset: gaiaAsset,
        lookAndFeel: lookAndFeel,
        payment: payment,
        marketConfig: marketConfig,
        selling: selling,
        minter: minter,
        network: useNetwork,
        risidioProjectId: 'ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW.thisisnumberone-v1',
        risidioBaseApi: risidioBaseApi,
        risidioStacksApi: 'http://localhost:20443',
        risidioWalletMac: '{"label": "MacMock", "mnemonic": "","keyInfo": {"privateKey": "4790db90a48e51bdbbc62a37fdc535719c22e195dc1aa6e1725b30bffc569ce501","address": "ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW","btcAddress": "","index": 0}}',
        risidioWalletSky: '{"label": "sky", "mnemonic": "","keyInfo": {"privateKey": "55ea24570fda8285e888cd239c55a91ab30023ae87af20887710d29b6ba6aeee01","address": "STFJEDEQB1Y1CQ7F04CS62DCS5MXZVSNXXN413ZG","btcAddress": "","index": 0}}',
        risidioCardMode: risidioCardMode
      }
      // document.getElementById('opcode').innerHTML = configuration.risidioCardMode
      window.risidioPaymentConfig = JSON.stringify(configuration)
    </script>
    <div id="risidio-pay" msg="aint no sunshine!"></div>
  </body>
</html>
